<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>面经 | duanthirty Blog</title><meta name="robots" content="noindex"><meta name="author" content="duanthirty Violet"><meta name="copyright" content="duanthirty Violet"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="写在最前 啊，要开始烦人的找工作了，写篇文记录一下，温故而知新  黑马学成详细说说你的项目吧                                从以下几个点介绍：项目背景，包括：自研还是外包、什么业务、服务的客户群是谁、谁去运营等问题。项目的业务流程。项目的功能模块。项目的技术架构。个人工作职责。个人负责模块的详细说明，包括模块的设计，所用到的技术和技术的实现方案等。我最近参与的项目是">
<meta property="og:type" content="article">
<meta property="og:title" content="面经">
<meta property="og:url" content="https://cyborg2077.github.io/2023/06/19/InterviewEXP/index.html">
<meta property="og:site_name" content="duanthirty&#39;s Blog">
<meta property="og:description" content="写在最前 啊，要开始烦人的找工作了，写篇文记录一下，温故而知新  黑马学成详细说说你的项目吧                                从以下几个点介绍：项目背景，包括：自研还是外包、什么业务、服务的客户群是谁、谁去运营等问题。项目的业务流程。项目的功能模块。项目的技术架构。个人工作职责。个人负责模块的详细说明，包括模块的设计，所用到的技术和技术的实现方案等。我最近参与的项目是">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pic2.zhimg.com/v2-d0a0172a71b6bc4ff18cd1f11bfa6b3b_r.jpg">
<meta property="article:published_time" content="2023-06-19T11:01:11.000Z">
<meta property="article:modified_time" content="2023-06-24T06:46:58.976Z">
<meta property="article:author" content="duanthirty Violet">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic2.zhimg.com/v2-d0a0172a71b6bc4ff18cd1f11bfa6b3b_r.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://cyborg2077.github.io/2023/06/19/InterviewEXP/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d54c3018e5f620d2cda0f5ca52ff80cb";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-RQZSMGWCQS"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-RQZSMGWCQS');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '面经',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-06-24 14:46:58'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><script data-pjax src="https://ali-oss.xmwpro.com/cdn/js/echarts.min.js"></script><script src="https://npm.elemecdn.com/echarts@5.3.2/dist/echarts.min.js"></script><link rel="stylesheet" href="/css/readPercent.css"><link rel="stylesheet" href="/css/custom/twikoo_beautify.css"  media="defer" onload="this.media='all'"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_3049706_6drr2nvsz9b.css"><link rel="stylesheet" href="/css/wave.css"><link rel="stylesheet" href="/css/custom.css"  media="defer" onload="this.media='all'"><style type="text/css"> #universe {  display: block; position: fixed; margin: 0; padding: 0; border: 0; outline: 0; left: 0; top: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; } </style><svg aria-hidden="true" style="position:absolute; overflow:hidden; width:0; height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-butterfly-clock/lib/clock.min.css"><link rel="stylesheet" href="/css/runtime.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.15/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://blog-picturetest.oss-cn-shanghai.aliyuncs.com/image/head.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">122</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">89</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw iconfont icon-liuyan"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw iconfont icon-shenghuo"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/gossip/"><i class="fa-fw iconfont icon-talk-new"></i><span> 闲言碎语</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw iconfont icon-bilibili"></i><span> 追番</span></a></li><li><a class="site-page child" href="/secret/"><i class="fa-fw fas fa-heart"></i><span> 记忆胶囊</span></a></li><li><a class="site-page child" href="/fitness/"><i class="fa-fw iconfont icon-jianshen-"></i><span> 健身日寄</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/reward/"><i class="fa-fw iconfont icon-zhangdan"></i><span> 打赏榜单</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://pic2.zhimg.com/v2-d0a0172a71b6bc4ff18cd1f11bfa6b3b_r.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">duanthirty Blog</a></span><div id="he-plugin-simple"></div><div id="none_space"></div><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw iconfont icon-liuyan"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw iconfont icon-shenghuo"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/gossip/"><i class="fa-fw iconfont icon-talk-new"></i><span> 闲言碎语</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw iconfont icon-bilibili"></i><span> 追番</span></a></li><li><a class="site-page child" href="/secret/"><i class="fa-fw fas fa-heart"></i><span> 记忆胶囊</span></a></li><li><a class="site-page child" href="/fitness/"><i class="fa-fw iconfont icon-jianshen-"></i><span> 健身日寄</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/reward/"><i class="fa-fw iconfont icon-zhangdan"></i><span> 打赏榜单</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">面经</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-06-19T11:01:11.000Z" title="发表于 2023-06-19 19:01:11">2023-06-19</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-06-24T06:46:58.976Z" title="更新于 2023-06-24 14:46:58">2023-06-24</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">14.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>48分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="面经"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="写在最前"><a href="#写在最前" class="headerlink" title="写在最前"></a>写在最前</h1><ul>
<li>啊，要开始烦人的找工作了，写篇文记录一下，温故而知新</li>
</ul>
<h1 id="黑马学成"><a href="#黑马学成" class="headerlink" title="黑马学成"></a>黑马学成</h1><h2 id="详细说说你的项目吧"><a href="#详细说说你的项目吧" class="headerlink" title="详细说说你的项目吧"></a>详细说说你的项目吧</h2><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <div class="note blue no-icon flat"><ul><li>从以下几个点介绍：<ol><li>项目背景，包括：自研还是外包、什么业务、服务的客户群是谁、谁去运营等问题。</li><li>项目的业务流程。</li><li>项目的功能模块。</li><li>项目的技术架构。</li><li>个人工作职责。</li><li>个人负责模块的详细说明，包括模块的设计，所用到的技术和技术的实现方案等。</li></ol></li></ul></div><div class="note pink no-icon flat"><ul><li>我最近参与的项目是公司自研的，针对成人职业技能教育的网络课堂系统，网站提供了承认职业技能培训的相关课程。如：软件开发培训、职业资格证书培训、成人学历教育培训等课程。项目基于B2B2C的业务模式，培训机构可以在平台入驻、发布课程，我们公司作为运营方由专门的人员对发布的课程进行审核、审核通过后的课程才可以发布成功，课程包括免费和付费两种形式，对于免费课程，普通用户可以直接选课进行学习，对于收费课程，需要在选课后成功支付才可以继续学习，同时收费课程也可以设置部分试学内容</li><li>本项目包括三个端：用户端（学生端）、机构端和运营端。</li><li>核心模块包括：内容管理、媒资管理、课程搜索、订单支付、选课管理、认证授权等。</li><li>本项目采用前后端分离架构，后端采用SpringBoot、SpringCloud技术栈开发，数据库使用MySQL，还使用了Redis、消息队列、分布式文件系统（MinIO）、ElasticSearch等中间件系统。</li><li><p>划分的微服务包括：内容管理服务、媒资管理服务、搜索服务、订单支付服务、学习中心服务、系统管理服务、认证授权服务、网关服务、注册中心服务、配置中心服务等。</p><ul><li><code>内容管理模块</code>，是对平台上的课程进行管理，课程的相关信息比较多，这里在数据库射击类课程基本信息表、课程营销表、课程计划表、课程师资表进行存储。培训机构要发布一门课程需要填写课程基本信息、课程营销信息、课程计划信息、课程师资信息，填写完毕后需要提交审核，由运营人员进行课程信息的审核，整个审核过程是程序自动审核加人工确认的方式，通常24小时审核完成。课程审核通过即可发布课程，课程的相关信息会聚合到课程发布表中，这里不仅要将课程信息写到课程发布表，还要将课程信息写到索引库、分布式文件系统中，所以这里存在分布式事务的问题，项目使用本地消息表加任务调度的方式去解决这里的分布式事务，保证数据的最终一致性。</li><li><code>媒资管理模块</code>，是教学机构在媒资管理系统管理自己的教学资源，包括：视频、教案等文件。主要的功能如下<ol><li>媒资查询：教学机构查询自己所拥有的媒资信息</li><li>文件上传：包括上传图片、上传文档、上传视频，其中上传视频采用了断点续传来优化网络状态不稳定的用户的体验，防止中途网络中断导致视频整体重新上传。</li><li>视频处理：视频上传成功，系统自动对视频进行编码处理，这里使用<code>ffmepg</code>来对视频处理，主要是将各种格式的视频文件转为<code>.avi</code>格式文件，以便在浏览器中直接播放</li><li>文件删除：教学机构删除自己上传的媒资文件</li></ol></li><li><code>学习中心服务</code>，实现了学生选课、下单支付、学习的整体流程。网站课程分为收费和付费两种，对于免费课程，学生选课后可以直接学习；对于付费课程，学生需要下单并且支付成功后，方可选课学习。其中，<code>选课</code>就是将课程加入到我的课程表的过程，免费课程可以直接添加到我的课程表，收费课程需要下单支付成功后，自动添加到我的课程表，自动添加是使用了RabbitMQ，当支付成功后，异步通知学习中心服务，将付费课程加入到<code>我的课程表</code>。对于支付方式，这里是接入了支付宝的支付服务。 </li></ul></li><li><p>项目工程结构：项目使用Maven来进行项目的管理和构建，整个项目分为三大类工程：父工程、基础工程和微服务工程</p><ul><li>父工程：主要是对依赖包的版本进行管理，本身为POM工程，对子工程进行聚合管理</li><li>基础工程：继承父类工程、提供基础类库、提供工具类库</li><li>微服务工程：分别从业务、技术方面划分模块，每个模块构建为一个微服务，每个微服务依赖基础工程，间接继承父工程</li></ul></li></ul></div>
              </div>
            </details>
<h2 id="递归查询"><a href="#递归查询" class="headerlink" title="递归查询"></a>递归查询</h2><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>我这里是使用递归查询查询的课程分类，因为有一级分类、二级分类、三级分类嘛，这个分类层级不是固定的，就比如有的大项底下只有二级分类，另外一个是有三级分类甚至四级分类的，针对这种情况，如果写普通的SQL，就是自连接那种的，就会很麻烦，如果后期层级又有五级的了，那还得改SQL。但是用递归查询就不用管那么多了，语法如下<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> <span class="keyword">RECURSIVE</span> <span class="operator">&lt;</span>cte_name<span class="operator">&gt;</span> <span class="keyword">AS</span> (</span><br><span class="line">  <span class="comment">-- 初始查询部分</span></span><br><span class="line">  <span class="operator">&lt;</span>initial_query<span class="operator">&gt;</span></span><br><span class="line">  <span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line">  <span class="comment">-- 递归查询部分</span></span><br><span class="line">  <span class="operator">&lt;</span>recursive_query<span class="operator">&gt;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="operator">&lt;</span>cte_name<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure></li><li>在这里，我们的初始查询部分就是给一个初值<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> <span class="keyword">RECURSIVE</span> t1 <span class="keyword">AS</span> (</span><br><span class="line">    <span class="comment">-- 初始查询部分</span></span><br><span class="line">    <span class="keyword">SELECT</span> p.<span class="operator">*</span> <span class="keyword">FROM</span> course_category p <span class="keyword">WHERE</span> p.id <span class="operator">=</span> <span class="number">1</span>    </span><br><span class="line">    <span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line">    <span class="comment">-- 递归查询部分，此时就已经将初始查询的结果赋值给了t1，递归查询p的子节点</span></span><br><span class="line">    <span class="keyword">SELECT</span> c.<span class="operator">*</span> <span class="keyword">FROM</span> course_category c <span class="keyword">JOIN</span> t1 <span class="keyword">WHERE</span> c.parentid <span class="operator">=</span> t1.id</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li></ul>
              </div>
            </details>
<h2 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h2><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ol><li>项目里是如何处理异常的？<ul><li>这里是自定义了一个统一的异常处理器去捕获并处理异常</li><li>使用控制器增强注解<code>@RestControllerAdvice</code>和异常处理注解<code>@ExceptionHandler</code>来实现<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@description</span> 全局异常处理器</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GlobalExceptionHandler</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(XueChengPlusException.class)</span></span><br><span class="line">    <span class="meta">@ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)</span> <span class="comment">// 该异常枚举错误码为500，</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RestErrorResponse <span class="title">customException</span><span class="params">(XueChengPlusException exception)</span> </span>&#123;</span><br><span class="line">        log.error(<span class="string">&quot;系统异常：&#123;&#125;&quot;</span>, exception.getErrMessage());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> RestErrorResponse(exception.getErrMessage());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(Exception.class)</span></span><br><span class="line">    <span class="meta">@ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RestErrorResponse <span class="title">exception</span><span class="params">(Exception exception)</span> </span>&#123;</span><br><span class="line">        log.error(<span class="string">&quot;系统异常：&#123;&#125;&quot;</span>, exception.getMessage());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> RestErrorResponse(exception.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li>如何处理自定义异常？<ul><li>首先定义一个自定义异常类，继承RuntimeException，这样在抛出异常时不需要显式地捕获或声明（因为运行时异常是自动抛出的）<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@description</span> 学成在线项目异常类</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XueChengPlusException</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String errMessage;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getErrMessage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> errMessage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">XueChengPlusException</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">XueChengPlusException</span><span class="params">(String errMessage)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(errMessage);</span><br><span class="line">        <span class="keyword">this</span>.errMessage = errMessage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">cast</span><span class="params">(CommonError commonError)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> XueChengPlusException(commonError.getErrMessage());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">cast</span><span class="params">(String errMessage)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> XueChengPlusException(errMessage);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>程序在编写代码时，根据校验结果主动抛出自定义异常类对象，抛出异常时指定详细的异常信息，然后由刚刚定义的异常处理器来捕获我们刚抛出的异常，然后响应结果给用户<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">- 下面是举例，编写代码时，校验价格是否合适，不合适则主动抛出自定义异常类对象，并指定异常信息</span><br><span class="line">``` JAVA</span><br><span class="line">if (price == null || price.floatValue() &lt;= 0) &#123;</span><br><span class="line">    XueChengPlusException.cast(&quot;课程设置了收费，价格不能为空，且必须大于0&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li>如何处理未知异常？<ul><li>接口执行过程中的一些运行时异常也会被全局异常处理器统一捕获、记录异常日志，统一响应给用户500错误<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="meta">@ExceptionHandler(Exception.class)</span></span><br><span class="line"><span class="meta">@ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> RestErrorResponse <span class="title">exception</span><span class="params">(Exception exception)</span> </span>&#123;</span><br><span class="line">    log.error(<span class="string">&quot;系统异常：&#123;&#125;&quot;</span>, exception.getMessage());</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> RestErrorResponse(exception.getMessage());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>在异常处理中，还可以对某个异常类型进行单独处理（使用@ExceptionHandler来声明要捕获的异常类型）</li></ul></li></ol>
              </div>
            </details>
<h2 id="请求参数校验"><a href="#请求参数校验" class="headerlink" title="请求参数校验"></a>请求参数校验</h2><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <div class="note blue no-icon flat"><ul><li>请求参数的合法性是如何校验的？</li></ul></div><div class="note pink no-icon flat"><ul><li>使用基于<code>JSR-303</code>的校验框架实现，SpringBoot提供了JSR-303的支持，它就是<code>spring-boot-starter-validation</code>，它包含了很多校验规则，只需要在模型类中通过注解指定校验规则，在Controller方法上使用<code>@Validated</code>注解开启校验</li><li>校验失败会抛出<code>MethodArgumentNotValidException</code>异常，我们可以在全局异常处理器中捕获并处理这个异常</li><li>由于在进行新增和修改时，对字段的校验规则可能不同，所以这里还用到了分组校验，在字段上方的注解中加入group属性，指定组别<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Null(message = &quot;订单id需为空&quot;, groups = Insert.class)</span></span><br><span class="line"><span class="meta">@NotEmpty(message = &quot;订单id不能为空&quot;, groups = Update.class)</span></span><br><span class="line"><span class="keyword">private</span> String id;</span><br></pre></td></tr></table></figure></li><li>同时在Controller方法上使用的<code>@Validated</code>注解里也需要加入属性，指定组别<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;新增课程基础信息接口&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/course&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> CourseBaseInfoDto <span class="title">createCourseBase</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Validated(ValidationGroups.Insert.class)</span> AddCourseDto addCourseDto)</span> </span>&#123;</span><br><span class="line">    Long companyId = <span class="number">22L</span>;</span><br><span class="line">    <span class="keyword">return</span> courseBaseInfoService.createCourseBase(companyId, addCourseDto);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></div>
              </div>
            </details>
<h2 id="说说MinIO吧"><a href="#说说MinIO吧" class="headerlink" title="说说MinIO吧"></a>说说MinIO吧</h2><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>本项目是用MinIO构建分布式文件系统，主要是十分轻量，而且使用简单，兼容Java。而且MinIO是采用去中心化共享架构的，每个节点都是对等的，具备相同的功能和能力，这意味着每个节点都可以存储和访问数据，那就可引入例如Nginx这种的负载均衡器，对MinIO集群进行负载均衡访问，可以提高系统性能和可用性，并且还可以避免单点故障。</li><li>MinIO使用纠删码技术来保护数据，它是一种恢复丢失和损坏数据的数学算法，它将数据分块，冗余地分散存储在各个节点的磁盘上，所有可用的磁盘组成一个集合，上图由8块硬盘组成一个集合，当上传一个文件时，会通过纠删码算法计算对文件进行分块存储，除了将文件本身分成4个数据块，还会生成4个校验块，数据块和校验开会分散的存储在这8块硬盘上。使用纠删码的好处是即便丢失一半数量(N/2)的硬盘，仍可以恢复数据。例如上面集合中有4个以内的硬盘损害，仍可保证数据恢复，不影响上传和下载；但如果多余一半的硬盘损坏，则无法恢复。</li><li>基本使用就是参考官方的SDK，看示例代码照着改一下就好了，有时候遇到很多不了解的东西，可以上GitHub上搜一下代码片段，看看别人怎么写的，然后自己照葫芦画瓢就行</li><li>分布式启动MinIO<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">minio.exe server D:\develop\minio_data\data1  D:\develop\minio_data\data2  D:\develop\minio_data\data3  D:\develop\minio_data\data4</span><br></pre></td></tr></table></figure></li><li>基本使用如下</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MinIOTest</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 创建MinioClient对象</span></span><br><span class="line">    <span class="keyword">static</span> MinioClient minioClient =</span><br><span class="line">            MinioClient.builder()</span><br><span class="line">                    .endpoint(<span class="string">&quot;http://127.0.0.1:9000&quot;</span>)</span><br><span class="line">                    .credentials(<span class="string">&quot;minioadmin&quot;</span>, <span class="string">&quot;minioadmin&quot;</span>)</span><br><span class="line">                    .build();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 上传测试方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">uploadTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            minioClient.uploadObject(</span><br><span class="line">                    UploadObjectArgs.builder()</span><br><span class="line">                            .bucket(<span class="string">&quot;testbucket&quot;</span>)</span><br><span class="line">                            .object(<span class="string">&quot;pic01.png&quot;</span>)    <span class="comment">// 同一个桶内对象名不能重复</span></span><br><span class="line">                            .filename(<span class="string">&quot;D:\\Picture\\background\\01.png&quot;</span>)</span><br><span class="line">                            .build()</span><br><span class="line">            );</span><br><span class="line">            System.out.println(<span class="string">&quot;上传成功&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;上传失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
              </div>
            </details>
<h2 id="说说断点续传吧"><a href="#说说断点续传吧" class="headerlink" title="说说断点续传吧"></a>说说断点续传吧</h2><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>断点续传一般都是前端先把文件进行分片，一般是JavaScript用ArrayBuffer将文件分片，然后按顺序上传文件块，如果上传过程中断了，可以通过判断前面的分块是否已经存在，来跳过一些分块。但是由于我也是第一次接触这种东西嘛，然后就用Java实现的</li><li>上传分块的话，可以用一个常量来指定块大小，然后根据文件大小和块大小，计算分块数量，向上取整（使用<code>Math.ceil()</code>），然后遍历分块数，依次向每一个分块写入数据</li><li>分块上传完毕后，就是合并分块，将分块文件按名称排序，然后依次读取并写入到最终文件。合并完毕后比较源文件和合并文件的MD5，MD5码相同返回成功结果，否则返回失败结果。</li></ul>
              </div>
            </details>
<h2 id="什么是分布式任务调度"><a href="#什么是分布式任务调度" class="headerlink" title="什么是分布式任务调度"></a>什么是分布式任务调度</h2><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>一般啊，这个任务调度都是定时发放一些优惠券，或者结算服务中定期生成一些报表数据</li></ul>
              </div>
            </details>
<h2 id="说说你在项目里XXL-JOB任务调度中心的应用吧"><a href="#说说你在项目里XXL-JOB任务调度中心的应用吧" class="headerlink" title="说说你在项目里XXL-JOB任务调度中心的应用吧"></a>说说你在项目里XXL-JOB任务调度中心的应用吧</h2><h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>首先我也是第一次接触XXL-JOB，然后就是直接上<a target="_blank" rel="noopener" href="https://www.xuxueli.com/xxl-job/">官网</a>看那个快速入门，配置一下数据库和线程池就行了，其他的可以在图形界面里改。然后就是在本机部署成功了，用maven的package打成一个jar包，然后放虚拟机上，<code>nohup java -jar xxl-job-admin.jar &amp;</code>放后台启动</li><li>然后这个XXL-JOB主要是由调度中心、执行器和任务组成的<ul><li>调度中心：负责管理调度信息，按照调度配置发出调度请求，自身不承担业务代码，主要职责是管理执行器和任务还有监控运维和日志管理</li><li>任务执行器：负责接收调度请求并执行任务逻辑，主要职责是注册服务、执行任务、上报执行结果</li><li>任务：腐恶执行具体的业务逻辑</li></ul></li><li>具体使用<ol><li>具体使用就是现在项目中导入依赖，依赖的版本控制是完成的<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xuxueli<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xxl-job-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li>然后就是在nacos里添加xxl-job的配置信息，appname配置的是执行器的名字，我们在调度中心的图形化界面配置执行器的时候，需要用到这个appname<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">xxl:</span></span><br><span class="line"><span class="attr">job:</span></span><br><span class="line">    <span class="attr">admin:</span></span><br><span class="line">    <span class="attr">addresses:</span> <span class="string">http://192.168.101.128:18088/xxl-job-admin/</span></span><br><span class="line">    <span class="attr">executor:</span></span><br><span class="line">    <span class="attr">appname:</span> <span class="string">media-process-service</span></span><br><span class="line">    <span class="attr">address:</span></span><br><span class="line">    <span class="attr">ip:</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">9999</span></span><br><span class="line">    <span class="attr">logpath:</span> <span class="string">/data/applogs/xxl-job-jobhandler</span></span><br><span class="line">    <span class="attr">logretentiondays:</span> <span class="number">30</span></span><br><span class="line">    <span class="attr">accessToken:</span> <span class="string">default_token</span></span><br></pre></td></tr></table></figure></li><li>然后创建一个配置类，使用<code>@Value</code>注解从nacos中读取配置<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XxlJobConfig</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Logger logger = LoggerFactory.getLogger(XxlJobConfig.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;xxl.job.admin.addresses&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String adminAddresses;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;xxl.job.accessToken&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String accessToken;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;xxl.job.executor.appname&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String appname;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;xxl.job.executor.address&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;xxl.job.executor.ip&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String ip;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;xxl.job.executor.port&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> port;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;xxl.job.executor.logpath&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String logPath;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;xxl.job.executor.logretentiondays&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> logRetentionDays;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> XxlJobSpringExecutor <span class="title">xxlJobExecutor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        logger.info(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job config init.&quot;</span>);</span><br><span class="line">        XxlJobSpringExecutor xxlJobSpringExecutor = <span class="keyword">new</span> XxlJobSpringExecutor();</span><br><span class="line">        xxlJobSpringExecutor.setAdminAddresses(adminAddresses);</span><br><span class="line">        xxlJobSpringExecutor.setAppname(appname);</span><br><span class="line">        xxlJobSpringExecutor.setAddress(address);</span><br><span class="line">        xxlJobSpringExecutor.setIp(ip);</span><br><span class="line">        xxlJobSpringExecutor.setPort(port);</span><br><span class="line">        xxlJobSpringExecutor.setAccessToken(accessToken);</span><br><span class="line">        xxlJobSpringExecutor.setLogPath(logPath);</span><br><span class="line">        xxlJobSpringExecutor.setLogRetentionDays(logRetentionDays);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> xxlJobSpringExecutor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 针对多网卡、容器内部署等情况，可借助 &quot;spring-cloud-commons&quot; 提供的 &quot;InetUtils&quot; 组件灵活定制注册IP；</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    *      1、引入依赖：</span></span><br><span class="line"><span class="comment">    *          &lt;dependency&gt;</span></span><br><span class="line"><span class="comment">    *             &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span></span><br><span class="line"><span class="comment">    *             &lt;artifactId&gt;spring-cloud-commons&lt;/artifactId&gt;</span></span><br><span class="line"><span class="comment">    *             &lt;version&gt;$&#123;version&#125;&lt;/version&gt;</span></span><br><span class="line"><span class="comment">    *         &lt;/dependency&gt;</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    *      2、配置文件，或者容器启动变量</span></span><br><span class="line"><span class="comment">    *          spring.cloud.inetutils.preferred-networks: &#x27;xxx.xxx.xxx.&#x27;</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    *      3、获取IP</span></span><br><span class="line"><span class="comment">    *          String ip_ = inetUtils.findFirstNonLoopbackHostInfo().getIpAddress();</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>在调度中心配置执行器<br><img src="https://s1.ax1x.com/2023/02/21/pSjm9u4.png" alt=""></li><li>编写我们的任务类<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 测试执行器</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleJob</span> </span>&#123;</span><br><span class="line">    <span class="meta">@XxlJob(&quot;testJob&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testJob</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log.debug(<span class="string">&quot;开始执行.......&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>在执行器中新增任务任务信息，JobHandler中填写的内容，即为<code>@XxlJob</code>注解里的内容<br><img src="https://s1.ax1x.com/2023/02/21/pSjn4Og.png" alt=""></li><li>启动任务，会按照我们的规则来自动执行任务</li></ol></li></ul>
              </div>
            </details>
<h3 id="那你是如何保证任务不重复执行的"><a href="#那你是如何保证任务不重复执行的" class="headerlink" title="那你是如何保证任务不重复执行的"></a>那你是如何保证任务不重复执行的</h3><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ol><li>调度中心是按照<code>分片广播</code>的方式下发任务的</li><li>执行器收到作业分片广播的参数：分片总数（shardTotal）和分片序号（shardIndex），计算<code>任务ID % 分片总数</code>（taskId % shardTotal），结果如果等于分片序号，就去执行这个任务。这样就可以保证不同的执行器执行不同的任务。</li><li>配置调度过期策略也要设置为<code>忽略</code>，避免同一个执行器多次重复执行一个任务</li><li>任务阻塞处理策略也需要设置为<code>丢弃后续调度</code>，丢弃了也没事，下一次调度的时候还可以执行</li><li>另外还要保证任务的幂等性，执行过的任务可以打一个标记（我这里是设置的一个状态标记，status = 2表示任务完成），下次再调度这个问题的时候，判断任务已经完成，就不再执行了</li></ol>
              </div>
            </details>
<h3 id="那你是如何保证任务的幂等性的"><a href="#那你是如何保证任务的幂等性的" class="headerlink" title="那你是如何保证任务的幂等性的"></a>那你是如何保证任务的幂等性的</h3><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>幂等性描述的是一次和多次请求某一个资源，对于资源本身，应该返回相同的结果，主要是为了解决重复提交的问题，就比如恶意刷单或者重复支付等情况。</li><li>我这里的解决方式是在数据库设置了一个状态处理字段，视频处理完成后，更新该字段为完成状态，执行视频处理之前判断是否完成。</li><li>一般来说解决这个幂等性有三种方案吧，我了解的只有三种<ol><li>数据库约束，例如：唯一索引、主键</li><li>乐观锁：常用于数据库，更新数据时，根据乐观锁的状态去更新</li><li>唯一序列号，请求前生成唯一的序列号，携带序列号去请求，执行的时候在redis记录该序列号，表示该序列号请求已经执行过了。如果相同的序列号再来执行，那就说明是重复执行</li></ol></li></ul>
              </div>
            </details>
<h2 id="你是怎么在Java中使用FFmepg进行视频转码的"><a href="#你是怎么在Java中使用FFmepg进行视频转码的" class="headerlink" title="你是怎么在Java中使用FFmepg进行视频转码的"></a>你是怎么在Java中使用FFmepg进行视频转码的</h2><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>首先先在电脑上配置一下这个FFmepg的环境变量，然后执行视频转码主要是在CMD窗口里执行命令嘛，Java里的ProcessBuilder类可以执行cmd命令<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//清除已生成的mp4</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">clear_mp4</span><span class="params">(String mp4_path)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//删除原来已经生成的m3u8及ts文件</span></span><br><span class="line">    File mp4File = <span class="keyword">new</span> File(mp4_path);</span><br><span class="line">    <span class="keyword">if</span> (mp4File.exists() &amp;&amp; mp4File.isFile()) &#123;</span><br><span class="line">        mp4File.delete();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 视频编码，生成mp4文件</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 成功返回success，失败返回控制台日志</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">generateMp4</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//清除已生成的mp4 </span></span><br><span class="line">    clear_mp4(mp4folder_path);</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    ffmpeg.exe -i  lucene.avi -c:v libx264 -s 1280x720 -pix_fmt yuv420p -b:a 63k -b:v 753k -r 18 .\lucene.mp4</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;String&gt; commend = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    commend.add(ffmpeg_path);</span><br><span class="line">    commend.add(<span class="string">&quot;-i&quot;</span>); </span><br><span class="line">    commend.add(video_path);</span><br><span class="line">    commend.add(<span class="string">&quot;-c:v&quot;</span>);</span><br><span class="line">    commend.add(<span class="string">&quot;libx264&quot;</span>);</span><br><span class="line">    commend.add(<span class="string">&quot;-y&quot;</span>);<span class="comment">//覆盖输出文件</span></span><br><span class="line">    commend.add(<span class="string">&quot;-s&quot;</span>);</span><br><span class="line">    commend.add(<span class="string">&quot;1280x720&quot;</span>);</span><br><span class="line">    commend.add(<span class="string">&quot;-pix_fmt&quot;</span>);</span><br><span class="line">    commend.add(<span class="string">&quot;yuv420p&quot;</span>);</span><br><span class="line">    commend.add(<span class="string">&quot;-b:a&quot;</span>);</span><br><span class="line">    commend.add(<span class="string">&quot;63k&quot;</span>);</span><br><span class="line">    commend.add(<span class="string">&quot;-b:v&quot;</span>);</span><br><span class="line">    commend.add(<span class="string">&quot;753k&quot;</span>);</span><br><span class="line">    commend.add(<span class="string">&quot;-r&quot;</span>);</span><br><span class="line">    commend.add(<span class="string">&quot;18&quot;</span>); </span><br><span class="line">    commend.add(mp4folder_path);</span><br><span class="line">    String outstring = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        ProcessBuilder builder = <span class="keyword">new</span> ProcessBuilder();</span><br><span class="line">        builder.command(commend);</span><br><span class="line">        <span class="comment">//将标准输入流和错误输入流合并，通过标准输入流程读取信息</span></span><br><span class="line">        builder.redirectErrorStream(<span class="keyword">true</span>);</span><br><span class="line">        Process p = builder.start();</span><br><span class="line">        outstring = waitFor(p);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">        ex.printStackTrace();</span><br><span class="line">    &#125; </span><br><span class="line">    Boolean check_video_time = <span class="keyword">this</span>.check_video_time(video_path, mp4folder_path);</span><br><span class="line">    <span class="keyword">if</span> (!check_video_time) &#123;</span><br><span class="line">        <span class="keyword">return</span> outstring;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul>
              </div>
            </details>
<h2 id="说说你是怎么用页面静态化技术的"><a href="#说说你是怎么用页面静态化技术的" class="headerlink" title="说说你是怎么用页面静态化技术的"></a>说说你是怎么用页面静态化技术的</h2><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>因为我们这个课程界面，按理说是八辈子不会变动一次的，或者不会频繁变动的，所以可以使用Freemarker模板引擎来生成静态页面，然后将静态页面上传至MinIO中，然后这样就不用每次都生成动态页面了，可以降低服务器压力</li><li>我对模板引擎的理解是：<code>模板</code> + <code>数据</code> = <code>输出</code>，之前学过一段时间JSP，JSP页面就可以是模板，然后里面嵌入的JSP标签就是数据，二者相结合，生成的就是HTML页面</li><li>基本使用<ol><li>首先也是导入依赖<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Spring Boot 对结果视图 Freemarker 集成 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-freemarker<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li>其次是在nacos中新增配置<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">freemarker:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">cache:</span> <span class="literal">false</span>   <span class="comment">#关闭模板缓存，方便测试</span></span><br><span class="line">    <span class="attr">settings:</span></span><br><span class="line">      <span class="attr">template_update_delay:</span> <span class="number">0</span></span><br><span class="line">    <span class="attr">suffix:</span> <span class="string">.ftl</span>   <span class="comment">#页面模板后缀名</span></span><br><span class="line">    <span class="attr">charset:</span> <span class="string">UTF-8</span></span><br><span class="line">    <span class="attr">template-loader-path:</span> <span class="string">classpath:/templates/</span>   <span class="comment">#页面模板位置(默认为 classpath:/templates/)</span></span><br><span class="line">    <span class="attr">resources:</span></span><br><span class="line">      <span class="attr">add-mappings:</span> <span class="literal">false</span>   <span class="comment">#关闭项目中的静态资源映射(static、resources文件夹下的资源)</span></span><br></pre></td></tr></table></figure></li><li>在需要的模块中以共享配置的方式，添加freemarker的配置<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">shared-configs:</span><br><span class="line">  - data-id: swagger-$&#123;spring.profiles.active&#125;.yaml</span><br><span class="line">    group: xuecheng-plus-common</span><br><span class="line">    refresh: true</span><br><span class="line">  - data-id: logging-$&#123;spring.profiles.active&#125;.yaml</span><br><span class="line">    group: xuecheng-plus-common</span><br><span class="line">    refresh: true</span><br><span class="line"><span class="addition">+ - data-id: freemarker-config-$&#123;spring.profiles.active&#125;.yaml</span></span><br><span class="line"><span class="addition">+   group: xuecheng-plus-common</span></span><br><span class="line"><span class="addition">+   refresh: true</span></span><br></pre></td></tr></table></figure></li><li>然后就是添加模板，freemarker配置中我们指定的是.ftl结尾，并且在classpath:/templates/目录下添加模板，这里添加<code>test.ftl</code><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">Hello $&#123;broski&#125;!</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li>编写Controller方法，准备填充数据<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FreemarkerController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/testfreemaker&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        <span class="comment">// 填写模板文件名前缀，后缀我们在配置文件中指定了</span></span><br><span class="line">        modelAndView.setViewName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">        modelAndView.addObject(<span class="string">&quot;broski&quot;</span>, <span class="string">&quot;duanthirty&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> modelAndView;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>将生成好的静态HTML页面上传至MinIO分布式文件系统，当客户端请求时，直接请求HTML页面</li></ol></li></ul>
              </div>
            </details>
<h2 id="了解分布式事务吗？"><a href="#了解分布式事务吗？" class="headerlink" title="了解分布式事务吗？"></a>了解分布式事务吗？</h2><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>我之前的那个项目的课程发布模块，涉及到了分布式事务，因为课程发布，需要向数据库、Redis、ElasticSearch、MinIO中写四份数据，这四个地方已经不限制在一个数据库里了，而是由四个分散的服务去提供，这四个服务有需要网络进行通信，但是网络存在不可到达性（比如断网），那么在这种分布式系统环境下，通过不同的服务进行网络通信去完成事务，称之为<code>分布式事务</code></li><li>控制分布式事务需要理解CAP理论，它指出一个分布式系统中最多同时满足一致性（Consistency）、可用性（Availability）和分区容忍性（Partition tolerance）这三项中的两项。<ol><li>一致性是指所有节点访问同一份最新的数据副本。</li><li>可用性是指每个请求都能得到响应。</li><li>分区容忍性是指系统能够在网络分区的情况下继续运行。</li></ol></li><li>例如我们添加一个小明用户的信息<br><img src="https://s1.ax1x.com/2023/03/04/ppAWthj.png" alt=""></li><li>如果满足一致性（Consistency），那么当小明的信息同步完成前，不能访问服务节点2，因为此时节点1和节点2的数据不一致。那么此时就不能保证节点2的可用性（Availability）。</li><li>如果满足可用性（Availability），要保证系统时刻都可用，那么就不用等待小明的信息同步完，此时系统无法保证一致性。</li><li>所以CA不能同时满足，在分布式中进行分布式事务控制，要么保证CP，要么保证AP</li><li>我们这里不需要保证一致性，满足可用性就好了，课程发布后，先更新数据库中的课程发布状态，然后向Redis、ElasticSearch、MinIO中写入课程信息。具体实现方式如下<ol><li>在内容管理服务的数据库中新增一个消息表。</li><li>当课程发布的时候，通过本地事务向课程发布表写入课程发布信息，同时也向消息表写入课程发布的消息，这两条信息需要保证事务，同时存在或同时不存在。</li><li>启动任务调度系统的定时调度，内容管理服务去定时扫描消息表的记录。</li><li>当扫描到课程发布信息时，即开始向Redis、ElasticSearch、MinIO完成同步数据的操作。</li><li>同步数据的任务完成后，删除消息表记录，并插入历史消息表</li></ol></li></ul>
              </div>
            </details>
<h2 id="项目有熔断降级措施吗？"><a href="#项目有熔断降级措施吗？" class="headerlink" title="项目有熔断降级措施吗？"></a>项目有熔断降级措施吗？</h2><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>当微服务运行不正常，会导致无法正常调用微服务，此时会出现异常，如果不去处理这种异常，可能会导致雪崩效应，当一个服务无法提供服务时，可能会导致其他服务也挂掉，从而可能导致整个系统都不可用。</li><li>使用熔断和降级措施可以解决雪崩效应。<ul><li>熔断：当下游服务异常时，断开与上游服务的交互。它就相当于保险丝，下游服务异常触发了熔断，从而保证上游业务不受影响</li><li>降级：当下游服务异常时，上游服务就不再去调用异常的服务，而是执行降级处理的逻辑，这个降级处理逻辑可以是本地的一个单独的方法。</li></ul></li><li>项目中我是使用Hystrix框架实现熔断、降级处理的<ol><li>开启feign熔断保护，在配置文件中设置<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">hystrix:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">circuitbreaker:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></li><li>定义降级逻辑<ul><li>方式一：fallback。定义一个fallback类MediaServiceClientFallback，此类实现了MediaServiceClient接口。<div class="tabs" id="实现mediaserviceclient"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#实现mediaserviceclient-1">MediaServiceClient接口</button></li><li class="tab"><button type="button" data-href="#实现mediaserviceclient-2">MediaServiceClientFallback类</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="实现mediaserviceclient-1"><ul><li>定义MediaServiceClient接口<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 媒资管理服务远程调用接口</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@FeignClient(value = &quot;media-api&quot;, configuration = MultipartSupportConfig.class, fallback = MediaServiceClientFallback.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MediaServiceClient</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/media/upload/coursefile&quot;, consumes = MediaType.MULTIPART_FORM_DATA_VALUE)</span></span><br><span class="line">    <span class="function">String <span class="title">upload</span><span class="params">(<span class="meta">@RequestPart(&quot;filedata&quot;)</span> MultipartFile upload,</span></span></span><br><span class="line"><span class="params"><span class="function">                <span class="meta">@RequestParam(value = &quot;folder&quot;, required = false)</span> String folder,</span></span></span><br><span class="line"><span class="params"><span class="function">                <span class="meta">@RequestParam(value = &quot;objectName&quot;, required = false)</span> String objectName)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="实现mediaserviceclient-2"><ul><li>定义MediaServiceClientFallback类<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MediaServiceClientFallback</span> <span class="keyword">implements</span> <span class="title">MediaServiceClient</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">upload</span><span class="params">(MultipartFile upload, String folder, String objectName)</span> </span>&#123;</span><br><span class="line">        log.debug(<span class="string">&quot;方式一：熔断处理，无法获取异常&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div></li><li>方式二：fallbackFactory，由于方式一无法取出熔断所抛出的异常，而方式二定义MediaServiceClientFallbackFactory可以解决这个问题<div class="tabs" id="两种降级方法"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#两种降级方法-1">MediaServiceClient接口</button></li><li class="tab"><button type="button" data-href="#两种降级方法-2">MediaServiceClientFallbackFactory类</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="两种降级方法-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 媒资管理服务远程调用接口</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@FeignClient(value = &quot;media-api&quot;, configuration = MultipartSupportConfig.class, fallbackFactory = MediaServiceClientFallbackFactory.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MediaServiceClient</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/media/upload/coursefile&quot;, consumes = MediaType.MULTIPART_FORM_DATA_VALUE)</span></span><br><span class="line">    <span class="function">String <span class="title">upload</span><span class="params">(<span class="meta">@RequestPart(&quot;filedata&quot;)</span> MultipartFile upload,</span></span></span><br><span class="line"><span class="params"><span class="function">                <span class="meta">@RequestParam(value = &quot;folder&quot;, required = false)</span> String folder,</span></span></span><br><span class="line"><span class="params"><span class="function">                <span class="meta">@RequestParam(value = &quot;objectName&quot;, required = false)</span> String objectName)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="两种降级方法-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MediaServiceClientFallbackFactory</span> <span class="keyword">implements</span> <span class="title">FallbackFactory</span>&lt;<span class="title">MediaServiceClient</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MediaServiceClient <span class="title">create</span><span class="params">(Throwable throwable)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MediaServiceClient() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">upload</span><span class="params">(MultipartFile upload, String folder, String objectName)</span> </span>&#123;</span><br><span class="line">                log.debug(<span class="string">&quot;方式二：熔断处理，熔断异常：&#123;&#125;&quot;</span>, throwable.getMessage());</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div></li></ul></li><li>降级处理逻辑：这里使用的是最简单的，返回一个null值，上游服务请求接口得到一个null，说明执行了降级处理。</li></ol></li></ul>
              </div>
            </details>
<h2 id="你项目中用ElasticSearch实现搜索功能"><a href="#你项目中用ElasticSearch实现搜索功能" class="headerlink" title="你项目中用ElasticSearch实现搜索功能"></a>你项目中用ElasticSearch实现搜索功能</h2><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>是的，课程发布操作执行后，需要在ElasticSearch中创建课程信息的索引，可以通过课程分类、课程难度等级和搜索框搜索，同时搜索结果也会高亮</li><li>具体操作<ol><li>先根据数据库的字段，来创建索引，有的字段不参与搜索，就不用创建索引。然后在在nacos中添加ElasticSearch的相关配置<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">context-path:</span> <span class="string">/search</span></span><br><span class="line"><span class="attr">port:</span> <span class="number">53080</span></span><br><span class="line"></span><br><span class="line"><span class="attr">elasticsearch:</span></span><br><span class="line"><span class="attr">hostlist:</span> <span class="number">192.168</span><span class="number">.101</span><span class="number">.128</span><span class="string">:9200</span>  </span><br><span class="line"><span class="attr">course:</span></span><br><span class="line">    <span class="attr">index:</span> <span class="string">course-publish</span></span><br><span class="line">    <span class="attr">source_fields:</span> <span class="string">id,companyId,companyName,name,users,grade,mt,mtName,st,stName,charge,pic,price,originalPrice,description,teachmode,validDays,createDate</span></span><br></pre></td></tr></table></figure></li><li>编写一个配置类<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ElasticsearchConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;elasticsearch.hostlist&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String hostlist;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RestHighLevelClient <span class="title">restHighLevelClient</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> RestHighLevelClient(RestClient.builder(hostlist));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>查询实现：<ul><li>整体采用布尔查询。</li><li>根据关键字查询，采用MultiMathchQuery，搜索name、description字段</li><li>根据分类、课程等级搜索，采用过滤器是吸纳</li><li>高亮显示就是将查询的结果加上HTML标签</li></ul></li></ol></li></ul>
              </div>
            </details>
<h2 id="那你在用ES的时候，是如何保证索引同步的呢？"><a href="#那你在用ES的时候，是如何保证索引同步的呢？" class="headerlink" title="那你在用ES的时候，是如何保证索引同步的呢？"></a>那你在用ES的时候，是如何保证索引同步的呢？</h2><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>依旧是使用本地任务表 + xxl-job 任务调度进行索引同步的，<ol><li>添加/修改/删除课程的同时，向任务表插入一条记录，这条记录就记录了是什添加/修改/删除</li><li>任务调度定时扫描任务表，根据任务表的内容对课程信息进行同步<ul><li>如果是添加操作，则将课程添加到索引库</li><li>如果是修改操作，则修改索引库中的课程</li><li>如果是删除操作，将课程信息从索引库删除</li></ul></li></ol></li></ul>
              </div>
            </details>
<h2 id="说说你是怎么开发认证授权模块的"><a href="#说说你是怎么开发认证授权模块的" class="headerlink" title="说说你是怎么开发认证授权模块的"></a>说说你是怎么开发认证授权模块的</h2><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>本项目采用<code>SpringSecurity + OAuth2 + JWT</code>令牌的方式开发的认证授权模块，这个使用步骤也比较固定啊，我之前给做过一个码头管理系统也用到的是<code>SpringSecurity + OAuth2 + JWT</code>的方式进行的权限控制。</li><li>Json Web Token（JWT）是一种使用Json格式传递数据的网络令牌技术</li><li>支持密码登录和微信登录，实现方式是靠beanName做区分的，例如密码登录，在@Service注解上可以加上name属性<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service(&quot;password_authservice&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PasswordAuthServiceImpl</span> <span class="keyword">implements</span> <span class="title">AuthService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> XcUserExt <span class="title">execute</span><span class="params">(AuthParamsDto authParamsDto)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>那么微信登录的@Service也加上对应的name属性<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service(&quot;wx_authservice&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WxAuthServiceImpl</span> <span class="keyword">implements</span> <span class="title">AuthService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> XcUserExt <span class="title">execute</span><span class="params">(AuthParamsDto authParamsDto)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>然后在登录接口获取登陆类型，来取出对应的bean，执行对应的逻辑<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> UserDetails <span class="title">loadUserByUsername</span><span class="params">(String s)</span> <span class="keyword">throws</span> UsernameNotFoundException </span>&#123;</span><br><span class="line">        AuthParamsDto authParamsDto = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            authParamsDto = JSON.parseObject(s, AuthParamsDto.class);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;认证请求数据格式不对：&#123;&#125;&quot;</span>, s);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;认证请求数据格式不对&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">+       <span class="comment">// 获取认证类型，beanName就是 认证类型 + 后缀，例如 password + _authservice = password_authservice</span></span><br><span class="line">+       String authType = authParamsDto.getAuthType();</span><br><span class="line">+       <span class="comment">// 根据认证类型，从Spring容器中取出对应的bean</span></span><br><span class="line">+       AuthService authService = applicationContext.getBean(authType + <span class="string">&quot;_authservice&quot;</span>, AuthService.class);</span><br><span class="line">+       XcUserExt user = authService.execute(authParamsDto);</span><br><span class="line">-       String name = authParamsDto.getUsername();</span><br><span class="line">-       <span class="comment">// 根据username去XcUser表中查询对应的用户信息</span></span><br><span class="line">-       XcUser user = xcUserMapper.selectOne(<span class="keyword">new</span> LambdaQueryWrapper&lt;XcUser&gt;().eq(XcUser::getUsername, name));</span><br><span class="line">        <span class="comment">// 返回空表示用户不存在，SpringSecurity会帮我们处理</span></span><br><span class="line">        <span class="keyword">if</span> (user == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 取出数据库存储的密码</span></span><br><span class="line">        String password = user.getPassword();</span><br><span class="line">        user.setPassword(<span class="keyword">null</span>);</span><br><span class="line">        String userString = JSON.toJSONString(user);</span><br><span class="line">        <span class="comment">// 创建UserDetails对象，并返回，注意这里的authorities必须指定</span></span><br><span class="line">        <span class="keyword">return</span> User.withUsername(userString).password(password).authorities(<span class="string">&quot;test&quot;</span>).build();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li><li>认证授权采用的是RBAC，就是五张表<ul><li>xc_user：用户表，存储了系统用户信息</li><li>xc_user_role：用户角色表，一个用户可拥有多个角色，一个角色可被多个用户拥有</li><li>xc_role：角色表，存储了系统的角色类型，角色类型包括：学生、老师、管理员、教学管理员、超级管理员</li><li>xc_permission：角色权限表，一个角色可拥有多个权限，一个权限可被多个角色拥有</li><li>xc_menu：权限菜单表，里面记录了各种操作的权限code </li></ul></li><li>JWT令牌中也会携带用户的权限信息，然后校验是否符合SpringSecurity框架提供的@PreAuthorize注解中的权限需求</li></ul>
              </div>
            </details>
<h2 id="说说你的支付流程"><a href="#说说你的支付流程" class="headerlink" title="说说你的支付流程"></a>说说你的支付流程</h2><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>首先就是去支付宝的开发者平台注册一个沙箱账号嘛，然后按照官方文档一顿配置，再用QRUtils工具类（就是生成二维码的工具类）来生成对应课程订单的业务信息。交易成功就设置订单成功状态，这个是数据库表中的一个字段，防止用户重复支付。<ul><li>查询支付结果的时候，主要是根据那个交易流水号查询，如果可以查到数据，就解析支付宝接口返回的结果，如果交易成功，是把系统生成的订单号、支付宝流水号、支付金额和交易状态写进数据库。</li></ul></li></ul>
              </div>
            </details>
<h2 id="说说你是用RabbitMQ都干了什么"><a href="#说说你是用RabbitMQ都干了什么" class="headerlink" title="说说你是用RabbitMQ都干了什么"></a>说说你是用RabbitMQ都干了什么</h2><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>订单支付成功之后，需要通知其他服务订单已经支付完成了，就比如学习中心服务，需要将付费课程添加到用户的课程表中。<ul><li>订单服务将消息发送给交换机，由交换机广播消息，每个订阅信息的微服务都可以接收到支付结果，微服务收到支付结果，根据订单的类型去更新自己业务的数据。</li><li>所以我这里是选择使用消息队列进行异步通知，并且需要保证消息的可靠性，即生产端将消息成功通知到服务端。<ol><li>消息发送到交换机</li><li>消息由交换机发送到队列</li><li>消费者收到消息进行处理</li></ol></li><li>我这里的消息就是传递一个MqMessage对象，这个对象里有关联的业务信息也对应的业务代码，消费者根据业务代码来判断是不是属于自己要处理的业务，如果是，就获取业务信息进行处理，如果业务代码是购买课程，那么业务信息就是订单号。</li></ul></li></ul>
              </div>
            </details>
<h1 id="Java中常见的集合"><a href="#Java中常见的集合" class="headerlink" title="Java中常见的集合"></a>Java中常见的集合</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ol><li>ArrayList：ArrayList是一个动态数组，可以根据需要自动增长和缩小。它实现了List接口，提供了在列表中添加、删除、修改和访问元素的方法。插入的平均时间复杂度是O(n)，因为需要将后面的元素后移。根据索引查找的时间复杂度是O(1)，根据值查找的时间复杂度是O(n)。</li><li>LinkedList：LinkedList是一个双向链表实现的列表。它实现了List和Deque接口，可以用于在列表中添加、删除和访问元素。相对于ArrayList，LinkedList在插入和删除的时间复杂度更低，为O(1)；但访问元素的性能更差，为O(n)。</li><li>HashSet：HashSet是一个基于哈希表实现的集合，它不允许重复元素，实现了Set接口，提供了高效的添加、删除和查找元素，元素的存储顺序不确定。插入删除和查找都是O(1)的时间复杂度。</li><li>TreeSet：TreeSet是一个基于红黑树实现的有序集合，它按照元素的自然顺序或者指定的比较器进行排序。红黑树是一种自平衡的二叉搜索树，可以保持元素的有序性，因此插入、删除和查找的平均时间复杂度是O(log n)，n是树中元素个数。</li><li>HashMap：HashMap是一个基于哈希表实现的键值对存储结构，通过哈希函数将键映射到桶的索引位置，并且使用链表或红黑树处理哈希冲突，它实现了Map接口，不允许出现重复的键，插入、删除和查找的平均时间复杂度为O(1)</li><li>TreeMap：TreeMap是一个基于红黑树实现的有序映射，实现了SortedMap接口，可以按照键的自然顺序或者指定的比较器进行排序。TreeMap提供了按序访问和操作键值对的方法。插入、删除和查找的平均时间复杂度为O(log n)，n为树中元素个数。</li><li>LinkedHashMap：LinkedHashMap是一个基于哈希表和双向链表的有序映射，它维护着元素的插入顺序或者访问顺序，允许按序访问和操作键值对。插入、删除和查找的平均时间复杂度为O(1)。 </li></ol>
              </div>
            </details>
<h1 id="说一下HashMap的实现"><a href="#说一下HashMap的实现" class="headerlink" title="说一下HashMap的实现"></a>说一下HashMap的实现</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>HashMap是Java中常用的数据结构，用于存储键值对。它基于哈希表实现，通过哈希函数将键映射到存储桶（bucket）上，以快速定位和访问存储的数据。具体实现细节如下<ol><li>存储结构：HashMap内部由一个数组和链表（或红黑树）组成。数组被称为哈希桶（Hash Bucket），每个桶可以存储多个键值对。</li><li>哈希函数：HashMap使用key的哈希码来计算哈希值，哈希函数将哈希值映射到数组索引上，确定键值对在哪个桶中存储。</li><li>哈希冲突：由于不同的键可能映射到相同的哈希值，此时就会发生哈希冲突，为了解决哈希冲突，HashMap使用链表或红黑树来存储具有相同哈希值的键值对。当链表长度超过阈值时（通常是8），链表会转换为红黑树，以提高查找效率。</li><li>扩容机制：HashMap的初始容量是16，当HashMap中存储的键值对数量超过负载因子（默认为0.5）与当前容量的乘积时，会触发扩容操作。扩容的方法是使用一个新的数组，数组大小为原来的两倍，并将所有键值对重新分配到新的桶中，以保持哈希表的平衡性。</li><li>迭代顺序：HashMap中的键值对是无序存储的，即插入的顺序不保证和遍历的顺序一致。如果有这方面的需求，可以考虑LinkedHashMap。</li><li>线程安全：HashMap在多线程环境下并不是线程安全的，如果需要在并发环境中使用，可以考虑ConcurrentHashMap。</li></ol></li></ul>
              </div>
            </details>
<h1 id="MySQL有哪些引擎"><a href="#MySQL有哪些引擎" class="headerlink" title="MySQL有哪些引擎"></a>MySQL有哪些引擎</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ol><li>MyISAM引擎：提供了高性能的插入、查询和索引功能。它支持表级锁定和全文搜索，但不支持事务和外键约束。</li><li>InnoDB引擎：InnoDB是MySQL的默认存储引擎，它提供了事务支持、行级锁定、外键约束和崩溃恢复等功能；适用于大多数应用场景，特别是需要事务支持和高并发性能的场景。</li><li>Memory引擎（也成为Heap引擎）：Memory引擎将数据存储在内存中，提供了非常高的插入和查询性能。它适用于临时表、缓存和其他需要快速读写的场景。但是由于数据存储在内存中，服务器重启或数据将丢失。</li><li>Archive引擎：Archive引擎以高效的方式存储和检索大量的归档数据，适用于数据仓库和日志存档等场景。它采用了压缩存储和顺序写入的方式，不支持索引和事务。</li><li>CSV引擎：CSV引擎以纯文本的CSV格式存储数据，适用于快速导入和导出数据。CSV引擎不支持索引和事务，对于大型表性能较差。</li></ol>
              </div>
            </details>
<h1 id="说说你对innoDB的理解"><a href="#说说你对innoDB的理解" class="headerlink" title="说说你对innoDB的理解"></a>说说你对innoDB的理解</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>InnoDB是现在MySQL的默认引擎，特点如下<ol><li>事务支持：InnoDB引擎支持ACID事务，保证了数据的完整性和一致性，使用多版本并发控制(MVCC)来实现高并发的读写操作。</li><li>同时它也支持行级锁定，就是不同的事务可以同时对表中的不同行进行读写操作，提高了并发性能。</li><li>也支持外键约束和崩溃恢复，使用事务日志和崩溃恢复日志来保证数据的持久性，它可以在数据库异常关闭或崩溃后进行自动回复，保证了数据的一致性和可靠性。</li><li>支持并发控制：InnoDB通过多版本并发控制(MVCC)来实现高并发和读写操作。使用了读写锁、快照读和多版本控制来实现不同事务之间的隔离性和并发性能。</li><li>全文检索：InnoDB引擎从MySQL5.6版本支持全文检索功能，全文检索使得在文本数据中进行复杂的搜搜和匹配变得更加高效便捷。</li></ol></li></ul>
              </div>
            </details>
<h1 id="Spring中的IOC和AOP"><a href="#Spring中的IOC和AOP" class="headerlink" title="Spring中的IOC和AOP"></a>Spring中的IOC和AOP</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>IOC（控制反转）是Spring框架的核心概念之一。它是一种设计原则，旨在降低组件之间的耦合度。传统的编程方式中，对象之间的依赖关系是由开发人员手动创建和管理的，而在IOC容器中，控制权被反转，由容器负责创建和管理对象之间的依赖关系。</li><li>在Spring中，IOC通过依赖注入（Dependency Injection，DI）实现。它可以通过构造函数、Setter方法或字段注入的方式，将依赖注入到对象中，从而实现对象之间的解耦合。通过IOC容器，我们可以配置和管理应用程序中的各种组件，如服务、DAO、控制器等。这种松耦合的设计可以使得应用程序更加灵活。</li><li>AOP（面向切面编程）是另一个重要的Spring概念。它提供了一种以横切关注点为中心的编程范式。横切关注点是指在应用程序中多个模块共享的功能，如日志记录、事务管理等。在传统的编程范式中，这些横切关注点会分散在应用程序的各个模块中，导致重复代码和难以维护的情况。</li><li>通过AOP，我们可以将横切关注点从核心业务逻辑里分离出来，并将其作为可重用的模块进行管理。在Spring中，AOP通过在运行时动态地将切面织入到应用程序的目标对象中来实现。切面由切点和通知组成。切点定义了在应用程序执行过程中要拦截的特定点，通知定义的是在切点处执行的附加行为。</li><li>通过使用IOC和AOP，Spring框架实现了高度可配置和可扩展的应用程序开发环境。IOC降低了组件之间的耦合度，使得代码更加灵活可维护；而AOP将横切关注点与核心业务逻辑分离，提高了代码的重用性和可维护性。这两个概念共同构建了Spring框架的基石，为开发人员提供了一种优雅和高效的方式来构建企业级应用程序。</li></ul>
              </div>
            </details>
<h1 id="如何对-MySQL-进行的调优"><a href="#如何对-MySQL-进行的调优" class="headerlink" title="如何对 MySQL 进行的调优"></a>如何对 MySQL 进行的调优</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>SQL优化是指对数据库中的SQL语句进行调整和优化，以提高查询和修改数据的效率，下面是一些常用的SQL优化手段<ol><li>查询语句中不要使用<code>SELECT *</code>：使用<code>SELECT *</code>会查询出所有的列，包括可能不需要的列，这样会增加查询的数据量，影响查询的效率。在实际应用中，应该尽量指定需要查询的列。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 优化前</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">user</span>;</span><br><span class="line"></span><br><span class="line"># 优化后</span><br><span class="line"><span class="keyword">SELECT</span> id, name, age <span class="keyword">FROM</span> <span class="keyword">user</span>;</span><br></pre></td></tr></table></figure></li><li>尽量减少子查询，使用关联查询(LEFT JOIN、RIGHT JOIN、INNER JOIN)替代：子查询是指在一个查询语句中嵌套另一个查询语句。由于子查询需要进行多次查询，因此会降低查询的效率。可以使用关联查询来替代子查询，以减少查询次数。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 优化前</span><br><span class="line"><span class="keyword">SELECT</span> name, age, (<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary) <span class="keyword">FROM</span> salary <span class="keyword">WHERE</span> salary.user_id <span class="operator">=</span> user.id) <span class="keyword">AS</span> max_salary <span class="keyword">FROM</span> <span class="keyword">user</span>;</span><br><span class="line"></span><br><span class="line"># 优化后</span><br><span class="line"><span class="keyword">SELECT</span> user.name user.age <span class="built_in">MAX</span>(salary.salary) <span class="keyword">AS</span> max_salary</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">user</span></span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> salary <span class="keyword">ON</span> user.id <span class="operator">=</span> salary.user_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> user.id, user.name, user.age;</span><br></pre></td></tr></table></figure></li><li>减少使用<code>IN</code>或<code>NOT IN</code>，使用<code>EXISTS</code>、<code>NOT EXISTS</code>或关联查询替代：<code>IN</code>和<code>NOT IN</code>查询会对列表中的每个值进行匹配，因此查询效率较低。可以使用<code>EXISTS</code>或<code>NOT EXISTS</code>查询语句或关联查询语句替代<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 优化前</span><br><span class="line"><span class="keyword">SELECT</span> name <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> user_id <span class="keyword">FROM</span> <span class="keyword">order</span> <span class="keyword">WHERE</span> status <span class="operator">=</span> <span class="string">&#x27;completed&#x27;</span>)</span><br><span class="line"># 优化后</span><br><span class="line"><span class="keyword">SELECT</span> name <span class="keyword">FROM</span> <span class="keyword">user</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">EXISTS</span> (<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">FROM</span> <span class="keyword">order</span> <span class="keyword">WHERE</span> order.user_id <span class="operator">-</span> user.id <span class="keyword">AND</span> order.status <span class="operator">=</span> <span class="string">&#x27;completed&#x27;</span>)</span><br></pre></td></tr></table></figure></li><li><code>OR</code>的查询尽量使用<code>UNION</code>和<code>UNION ALL</code>代替（在确认没有重复数据或不用去重数据时，UNION ALL会更好）：<code>OR</code>查询语句会对多个条件进行匹配，而<code>UNION</code>和<code>UNION ALL</code>查询语句会将多个查询语句的结果合并。在确定没有重复数据或不需要剔除重复数据时，使用<code>UNION ALL</code>会比<code>UNION</code>更高效。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 优化前</span><br><span class="line"></span><br><span class="line"># 优化后</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li>尽量避免在<code>WHERE</code>子句中使用<code>!=</code>、<code>&lt;&gt;</code>操作符，否则引擎将放弃使用索引而进行全表扫描，可以使用<code>=</code>操作符或<code>NOT</code>操作符来替代<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 优化前</span><br><span class="line"><span class="keyword">SELECT</span> name <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> age <span class="operator">&lt;&gt;</span> <span class="number">18</span>;</span><br><span class="line"># 优化后</span><br><span class="line"><span class="keyword">SELECT</span> name <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> age <span class="operator">&lt;</span> <span class="number">18</span> <span class="keyword">OR</span> age <span class="operator">&gt;</span> <span class="number">18</span>;</span><br></pre></td></tr></table></figure></li><li>尽量避免在<code>WHERE</code>子句中对字段进行NULL值判断，否则将导致引擎放弃使用索引而进行全表扫描，如<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> id <span class="keyword">FROM</span> tb <span class="keyword">WHERE</span> id <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"># 改为如下形式，前提是num设置默认值为<span class="number">0</span>，确保num列不会出现<span class="keyword">NULL</span>值</span><br><span class="line"><span class="keyword">SELECT</span> id <span class="keyword">FROM</span> tb <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">0</span></span><br></pre></td></tr></table></figure></li></ol></li></ul>
              </div>
            </details> 
<h1 id="了解红黑树吗"><a href="#了解红黑树吗" class="headerlink" title="了解红黑树吗"></a>了解红黑树吗</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>红黑树是一种自平衡的二叉搜索树，它在插入和删除节点时通过执行颜色变换和旋转操作来保持平衡。具有以下特性：<ol><li>节点是红色或黑色：每个节点都被赋予红色或黑色。</li><li>根节点是黑色：树的根节点是黑色。</li><li>叶子节点（NIL节点）是黑色：叶子节点是特殊的NIL节点，它们被认为是黑色的。</li><li>红色节点的子节点必须是黑色：不能有两个相邻的红色节点。</li><li>从任一节点到其每个叶子的所有路径都包含相同数目的黑色节点：保证了树的平衡性。</li></ol></li><li>这些特性保证了红黑树在插入和删除节点时能够自动调整树的结构，以保持平衡。通过执行颜色变换和旋转操作，红黑树能够维持较为平衡的高度，使得在最坏情况下，树的高度为O(log n)，其中n是树中节点的数量。这使得红黑树在实践中被广泛用于需要高效的插入、删除和搜索操作的数据结构和算法中。</li></ul>
              </div>
            </details>
<h1 id="说一下自定义-SpringBoot-starters-的流程"><a href="#说一下自定义-SpringBoot-starters-的流程" class="headerlink" title="说一下自定义 SpringBoot starters 的流程"></a>说一下自定义 SpringBoot starters 的流程</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ol><li>定义starter模块：创建一个新的Maven模块，作为自定义starter的基础，起名的时候注意按照规范起名。</li><li>添加依赖项：在自定义starter模块的pom文件中，添加所需的依赖项。<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-autoconfigure<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li>定义配置属性Bean：根据我们的业务需求，需要在starter模块中定义一个属性类，用于存储这些配置属性的值，就比如在配置文件中配置MySQL的连接四要素一样。这里需要使用Spring的<code>@ConfigurationProperties</code>定义属性的前缀和默认值<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableConfigurationProperties(SimpleBean.class)</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;simplebean&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleBean</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;SimpleBean&#123;&quot;</span> +</span><br><span class="line">            <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">            <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">            <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>创建自动配置类：在starter模块中创建一个自动配置类，用于配置和初始化自定义功能。这个自动配置类需要用@Configuration注解标记，并使用其他Spring注解来定义和配置Bean、属性等。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@ConditionalOnClass：当类路径classpath下有指定的类的情况下进行自动配置，此处表示无限制，直接自动注册</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ConditionalOnClass</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAutoConfiguration</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;MyAutoConfiguration init....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SimpleBean <span class="title">simpleBean</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SimpleBean();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>编写/META-INF/spring.factories供SpringBoot扫描，因为Spring的启动过程中的自动配置，是查找classpath上所有jar包中的<code>META-INF/spring.factories</code> 和<code>.imports</code>文件中的配置类，进行的自动装配。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.boot.autoconfigure.EnableAutoConfiguration=\</span><br><span class="line">com.lagou.config.MyAutoConfiguration</span><br></pre></td></tr></table></figure></li></ol>
              </div>
            </details>
<h1 id="在项目中使用那些设计模式，具体介绍一下单例模式"><a href="#在项目中使用那些设计模式，具体介绍一下单例模式" class="headerlink" title="在项目中使用那些设计模式，具体介绍一下单例模式"></a>在项目中使用那些设计模式，具体介绍一下单例模式</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <div class="tabs" id="饿汉式和懒汉式"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#饿汉式和懒汉式-1">饿汉式</button></li><li class="tab"><button type="button" data-href="#饿汉式和懒汉式-2">懒汉式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="饿汉式和懒汉式-1"><ul><li>当使用饿汉式实现单例模式时，实例在类被加载的时候创建，无需延迟加载<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance = <span class="keyword">new</span> Singleton();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Singleton &#123;</span><br><span class="line">        <span class="comment">// 私有化w构造函数</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></li><li>在上述代码中，私有构造函数保证了其他类无法直接实例化Singleton类。static静态变量将instance实例在类加载时就被初始化，并通过公共静态方法getInstance()返回实例，保证了整个应用程序只有一个Singleton实例存在。</li><li>它的缺点是无法实现延迟记载，即使在某些情况下没有用到该单例对象，它仍会被创建，这可能导致不必要的资源占用。</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="饿汉式和懒汉式-2"><ul><li>懒汉式是一种延迟加载的单例模式，即需要使用该单例对象的时候，对象才会被创建，减少了资源的消耗。但是需要考虑线程的安全性和性能开销。多线程环境下如果不加synchronized关键字，可能会创建多个对象，但是加了synchronized关键字又会影响性能。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Signleton</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Singleton &#123;</span><br><span class="line">        <span class="comment">// 私有化构造函数</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
              </div>
            </details> 
<h1 id="乐观锁如何实现的"><a href="#乐观锁如何实现的" class="headerlink" title="乐观锁如何实现的"></a>乐观锁如何实现的</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>乐观锁的思想是：假设并发访问的情况下，数据很少会发生冲突，因此在访问数据前不会加锁，而是通过在数据上增加版本号等机制来判断数据是否被修改。</li><li>乐观锁的实现方式一般是通过在数据库表增加一个版本号或时间戳等字段，每次修改数据时都会更新这个版本号，如果读取数据发现版本号与预期的不一致，则说明数据已经被其他用户修改，需要重新读取数据。</li></ul>
              </div>
            </details>
<h1 id="什么是数据库索引？作用？"><a href="#什么是数据库索引？作用？" class="headerlink" title="什么是数据库索引？作用？"></a>什么是数据库索引？作用？</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>数据库索引是一种数据结构，用于提高数据库查询的效率，减少了对数据进行全表扫描的需求</li></ul>
              </div>
            </details>
<h1 id="解释一下聚集索引和非聚集索引的区别"><a href="#解释一下聚集索引和非聚集索引的区别" class="headerlink" title="解释一下聚集索引和非聚集索引的区别"></a>解释一下聚集索引和非聚集索引的区别</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>聚集索引：数据行的物理顺序与索引的逻辑顺序相匹配。一个表只能拥有一个聚集索引，通常是主键。聚集索引的叶子节点存储了完整的数据行。</li><li>非聚集索引：数据行的物理顺序与索引的逻辑顺序不匹配。一个表可以有多个非聚集索引，非聚集索引的叶子节点存储了索引键和指向数据行的指针。</li></ul>
              </div>
            </details>
<h1 id="什么是唯一索引？作用？"><a href="#什么是唯一索引？作用？" class="headerlink" title="什么是唯一索引？作用？"></a>什么是唯一索引？作用？</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>唯一索引是一种索引，它要求索引列中的值是唯一的，不允许重复。唯一索引可以保证表中的某个或某些列的值是唯一的，提供了数据的完整性和一致性。它常用于约束数据库表中的唯一性字段，例如用户的用户名、电子邮件地址等。</li></ul>
              </div>
            </details>
<h1 id="解释一下数据库索引的数据结构中常用的B树和B-树"><a href="#解释一下数据库索引的数据结构中常用的B树和B-树" class="headerlink" title="解释一下数据库索引的数据结构中常用的B树和B+树"></a>解释一下数据库索引的数据结构中常用的B树和B+树</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>B树：B树是一种自平衡的多路搜索树，它对数据进行排序并允许高效的查找、插入和删除操作。B树的特点是节点可以有多个子节点，并且保持平衡，适用于磁盘存储和范围查询操作。</li><li>B+树：B+树也是一种自平衡的多路搜索树，它在B树的基础上进行了优化。B+树的叶子节点形成了一个有序链表，可以快速进行范围查询和排序操作。B+树常用于数据库索引结构，具有更好的查询性能和顺序访问性能。</li></ul>
              </div>
            </details>
<h1 id="什么情况下应该创建索引？什么情况下不应该"><a href="#什么情况下应该创建索引？什么情况下不应该" class="headerlink" title="什么情况下应该创建索引？什么情况下不应该"></a>什么情况下应该创建索引？什么情况下不应该</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>应该创建索引的情况：<ol><li>经常用于查询的列或列组合。</li><li>用于连接（Join）操作的列。</li><li>用于排序和分组的列。 </li><li>唯一性约束的列。</li></ol></li><li>不应该创建索引的情况：<ol><li>数据库表很小，查询操作很快。</li><li>数据更新非常频繁，索引的维护开销大。</li><li>索引列的基数（唯一值的个数）非常小。</li></ol></li></ul>
              </div>
            </details>
<h1 id="如何优化索引性能？列举一些常见的索引优化技巧"><a href="#如何优化索引性能？列举一些常见的索引优化技巧" class="headerlink" title="如何优化索引性能？列举一些常见的索引优化技巧"></a>如何优化索引性能？列举一些常见的索引优化技巧</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ol><li>确保索引列的选择性较高，即唯一值的个数相对较大。</li><li>避免创建过多的索引，避免冗余和重复索引。</li><li>根据查询的特点和频率选择合适的索引类型。</li><li>定期更新统计信息，使优化器能够更好地选择索引。</li><li>避免过度索引覆盖和过度索引使用。</li><li>对长时间运行的查询进行调优，避免索引失效的情况。</li></ol>
              </div>
            </details>
<h1 id="如何处理长时间运行的查询导致索引失效的问题？"><a href="#如何处理长时间运行的查询导致索引失效的问题？" class="headerlink" title="如何处理长时间运行的查询导致索引失效的问题？"></a>如何处理长时间运行的查询导致索引失效的问题？</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ol><li>分析查询执行计划，查看索引是否被正确使用。</li><li>确保查询语句中的条件列与索引列的数据类型和顺序一致。</li><li>考虑重建或重新组织索引，以消除索引碎片和提高索引的选择性。</li><li>优化查询语句，使用合适的连接方式和条件筛选顺序。</li><li>调整数据库参数和配置，以提高查询性能。</li></ol>
              </div>
            </details>
<h1 id="说说TCP与UDP的区别，以及各自的优缺点"><a href="#说说TCP与UDP的区别，以及各自的优缺点" class="headerlink" title="说说TCP与UDP的区别，以及各自的优缺点"></a>说说TCP与UDP的区别，以及各自的优缺点</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ol><li>TCP是面向连接的（就比如打电话之前先要拨号），UDP是无连接的，发送数据之前不需要建立连接。</li><li>TCP提供可靠的服务。也就是说，通过TCP连接传送的数据，无差错，不丢失，不重复，且按需到达。UDP尽最大努力交付，不保证可靠交付。TCP通过校验和、重传控制、序号标识、滑动窗口、确认应答等机制实现可靠传输。</li></ol>
              </div>
            </details>
<h1 id="TCP如何保证可靠性"><a href="#TCP如何保证可靠性" class="headerlink" title="TCP如何保证可靠性"></a>TCP如何保证可靠性</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ol><li>序列号和确认号机制：TCP发送端发送数据包的时候会选择一个seq序列号，接收端收到数据包后会检测数据包的完整性，如果检测通过，会响应一个ack确认号表示收到了数据包。</li><li>超时重发机制：TCP发送端发送了数据包后会启动一个定时器，如果一定时间内没有收到接收端的确认，将会重新发送该数据包</li><li>对乱序数据包重新排序：从IP网络层传输到TCP层的数据包可能会乱序，TCP层会对数据包重新排序再发给应用层。</li><li>丢弃重复数据：从IP网络层传输到TCP层的数据包可能会重复，TCP层会丢弃重复的数据包</li><li>流量控制：TCP发送端和接收端都有一个固定大小的缓冲空间，为了防止发送端发送数据的速度太快导致接收端缓冲区溢出，发送端只能发送接收端可以接纳的数据，为了达到这种控制效果，TCP用了流量控制协议（可变大小的滑动窗口协议）来实现。</li></ol>
              </div>
            </details>
<h1 id="说说TCP的三次握手与四次挥手"><a href="#说说TCP的三次握手与四次挥手" class="headerlink" title="说说TCP的三次握手与四次挥手"></a>说说TCP的三次握手与四次挥手</h1><details class="folding-tag" cyan><summary>  </summary>
              <div class='content'>
              <ul><li>三次握手的目的：为了让双方都知道可以互相通信<ol><li>第一次握手（SYN）：客户端发送一个带有SYN（同步）标志的连接请求保温到服务器端，表明客户端想建立一个连接。</li><li>第二次握手（SYN + ACK）：服务器端接收到客户端的连接请求后，如果同意建立连接，会发送一个带有SYN和ACK（确认）标志的报文作为回应。</li><li>第三次握手（ACK）：客户端接收到服务端的回应后，会再次发送一个确认报文，其中ACK标志被设置为已确认。这个报文发送后，连接正式建立，双方可以进行数据传输。<div class="note warning no-icon flat"><ul><li>为什么是三次握手？两次行不行？<ul><li>两次是不行的，如果客户端第一次发送的SYN标志由于网络阻塞，没有成功发送服务端。那么此时客户端会重发一个SYN标志，此时服务端成功接收到了，与此同时，客户端第一次发送的SYN标志也到达了服务端，那么此时服务端认为客户端发起了两次连接，而客户端认为只发起了一次连接，造成了状态的不一致。</li></ul></li></ul></div></li></ol></li><li>四次挥手<ol><li>第一步（FIN）：客户端发送一个FIN报文给服务端，表明客户端没有数据要发送了，请求关闭连接</li><li>第二步（ACK）：服务端接收到关闭请求后，发送一个ACK报文给客户端，表明已经将收到关闭请求。此时服务端可能仍有数据要发送，因此可以继续发送剩余的数据</li><li>第三步（FIN）：当服务端将剩余的数据发送完毕后，发送一个FIN报文给客户端，表明自己也没有数据要发送了，请求关闭连接。</li><li>第四步（ACK）：客户端收到服务端的关闭请求后，发送一个ACK报文作为回应，表示已经接收到服务端的关闭请求。双方进入TIME_WAIT状态，在这个状态下等待一段时间后才会完全关闭连接。这个等待时间是为了确保最后一个ACK报文能够被对方接收，以防止连接无法正确关闭。如果在规定的等待时间内还没有收到对方的ACK，发送方会重新发送第三步中的FIN报文。</li></ol></li></ul>
              </div>
            </details>
<link rel="stylesheet" href="/css/bilicard.css" type="text/css"><!-- flag of hidden posts --></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">duanthirty Violet</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://cyborg2077.github.io/2023/06/19/InterviewEXP/">https://cyborg2077.github.io/2023/06/19/InterviewEXP/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://cyborg2077.github.io" target="_blank">duanthirty Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://pic2.zhimg.com/v2-d0a0172a71b6bc4ff18cd1f11bfa6b3b_r.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><link rel="stylesheet" href="/css/coin.css" media="defer" onload="this.media='all'"/><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">不给糖就捣蛋~</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.svg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.svg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.svg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.svg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></button></div><script defer="defer" src="/js/coin.js"></script><nav class="pagination-post" id="pagination"></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="cols"><div class="col"><div class="container"><div class="front avatarPanel"><div class="inner"><div class="player-title">Attributes</div><div class="player-avatar"><img src="https://blog-picturetest.oss-cn-shanghai.aliyuncs.com/image/head.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div></div></div><div class="back attributesPanel"><div class="inner"><div class="player-lv">LV.13</div><div class="player-name">duanthirty Violet</div><div class="attributes-value"><div class="attributes-value-item"><a href="/archives/"><div class="attributes">文章</div><div class="value-bar"><div class="value-bar-fill" style="width:61.00%"><div class="value-bar-fill-in" style="background: rgba(89, 230, 54,0.6)"></div></div></div><span>122/200</span></a></div><div class="attributes-value-item"><a href="/tags/"><div class="attributes">标签</div><div class="value-bar"><div class="value-bar-fill" style="width:89.00%"><div class="value-bar-fill-in" style="background: rgba(224, 20, 20, 0.6)"></div></div></div><span>89/100</span></a></div><div class="attributes-value-item"><a href="/categories/"><div class="attributes">分类</div><div class="value-bar"><div class="value-bar-fill" style="width:10.00%"><div class="value-bar-fill-in" style="background: rgba(30, 97, 226, 0.6)"></div></div></div><span>10/100</span></a></div></div></div></div></div></div><div class="col"><div class="container"><div class="front descriptionPanel"><div class="inner"><div class="player_description">The furthest distance in the world <br>ls not between life and death <br>But when l stand in front of you <br> Yet you don't know that l love you</div><div class="play-bottom"></div></div></div><div class="back buttonPanel"><div class="inner"><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/duanthirty"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/duanthirty" target="_blank" title="Github"><i class="iconfont icon-github"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;uin=1263907678&amp;site=qq&amp;menu=yes" target="_blank" title="QQ"><i class="iconfont icon-QQ"></i></a><a class="social-icon" href="https://music.163.com/#/user/home?id=8495736674" target="_blank" title="网抑云"><i class="iconfont icon-wangyiyunyinleclick"></i></a><a class="social-icon" href="https://space.bilibili.com/354459260" target="_blank" title="Bilibili"><i class="iconfont icon-bilibili"></i></a><a class="social-icon" href="https://steamcommunity.com/profiles/76561198851566538/" target="_blank" title="Steam"><i class="iconfont icon-steam"></i></a></div><div class="play-bottom"></div></div></div></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">如果在阅读过程中遇到了问题，可以随时联系我，看到了会在第一时间给出回复（不负责DEBUG，除非我真的写的有问题），在上面名片的背面点击QQ图标就可以了哦（免加好友的临时会话）<br><br>评论区现在采用Giscus，需登录Github方能评论<br><br>碎碎念移至生活版块的闲言碎语，使用TimeLine外挂标签替代</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E6%9C%80%E5%89%8D"><span class="toc-number">1.</span> <span class="toc-text">写在最前</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%BB%91%E9%A9%AC%E5%AD%A6%E6%88%90"><span class="toc-number">2.</span> <span class="toc-text">黑马学成</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%A6%E7%BB%86%E8%AF%B4%E8%AF%B4%E4%BD%A0%E7%9A%84%E9%A1%B9%E7%9B%AE%E5%90%A7"><span class="toc-number">2.1.</span> <span class="toc-text">详细说说你的项目吧</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%92%E5%BD%92%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.2.</span> <span class="toc-text">递归查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%82%E5%B8%B8"><span class="toc-number">2.3.</span> <span class="toc-text">异常</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C"><span class="toc-number">2.4.</span> <span class="toc-text">请求参数校验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%B4%E8%AF%B4MinIO%E5%90%A7"><span class="toc-number">2.5.</span> <span class="toc-text">说说MinIO吧</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%B4%E8%AF%B4%E6%96%AD%E7%82%B9%E7%BB%AD%E4%BC%A0%E5%90%A7"><span class="toc-number">2.6.</span> <span class="toc-text">说说断点续传吧</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%88%86%E5%B8%83%E5%BC%8F%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6"><span class="toc-number">2.7.</span> <span class="toc-text">什么是分布式任务调度</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%B4%E8%AF%B4%E4%BD%A0%E5%9C%A8%E9%A1%B9%E7%9B%AE%E9%87%8CXXL-JOB%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83%E7%9A%84%E5%BA%94%E7%94%A8%E5%90%A7"><span class="toc-number">2.8.</span> <span class="toc-text">说说你在项目里XXL-JOB任务调度中心的应用吧</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">2.8.1.</span> <span class="toc-text">基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%82%A3%E4%BD%A0%E6%98%AF%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E4%BB%BB%E5%8A%A1%E4%B8%8D%E9%87%8D%E5%A4%8D%E6%89%A7%E8%A1%8C%E7%9A%84"><span class="toc-number">2.8.2.</span> <span class="toc-text">那你是如何保证任务不重复执行的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%82%A3%E4%BD%A0%E6%98%AF%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E4%BB%BB%E5%8A%A1%E7%9A%84%E5%B9%82%E7%AD%89%E6%80%A7%E7%9A%84"><span class="toc-number">2.8.3.</span> <span class="toc-text">那你是如何保证任务的幂等性的</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%A0%E6%98%AF%E6%80%8E%E4%B9%88%E5%9C%A8Java%E4%B8%AD%E4%BD%BF%E7%94%A8FFmepg%E8%BF%9B%E8%A1%8C%E8%A7%86%E9%A2%91%E8%BD%AC%E7%A0%81%E7%9A%84"><span class="toc-number">2.9.</span> <span class="toc-text">你是怎么在Java中使用FFmepg进行视频转码的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%B4%E8%AF%B4%E4%BD%A0%E6%98%AF%E6%80%8E%E4%B9%88%E7%94%A8%E9%A1%B5%E9%9D%A2%E9%9D%99%E6%80%81%E5%8C%96%E6%8A%80%E6%9C%AF%E7%9A%84"><span class="toc-number">2.10.</span> <span class="toc-text">说说你是怎么用页面静态化技术的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%86%E8%A7%A3%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E5%90%97%EF%BC%9F"><span class="toc-number">2.11.</span> <span class="toc-text">了解分布式事务吗？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E6%9C%89%E7%86%94%E6%96%AD%E9%99%8D%E7%BA%A7%E6%8E%AA%E6%96%BD%E5%90%97%EF%BC%9F"><span class="toc-number">2.12.</span> <span class="toc-text">项目有熔断降级措施吗？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%A0%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%94%A8ElasticSearch%E5%AE%9E%E7%8E%B0%E6%90%9C%E7%B4%A2%E5%8A%9F%E8%83%BD"><span class="toc-number">2.13.</span> <span class="toc-text">你项目中用ElasticSearch实现搜索功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%82%A3%E4%BD%A0%E5%9C%A8%E7%94%A8ES%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E6%98%AF%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E7%B4%A2%E5%BC%95%E5%90%8C%E6%AD%A5%E7%9A%84%E5%91%A2%EF%BC%9F"><span class="toc-number">2.14.</span> <span class="toc-text">那你在用ES的时候，是如何保证索引同步的呢？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%B4%E8%AF%B4%E4%BD%A0%E6%98%AF%E6%80%8E%E4%B9%88%E5%BC%80%E5%8F%91%E8%AE%A4%E8%AF%81%E6%8E%88%E6%9D%83%E6%A8%A1%E5%9D%97%E7%9A%84"><span class="toc-number">2.15.</span> <span class="toc-text">说说你是怎么开发认证授权模块的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%B4%E8%AF%B4%E4%BD%A0%E7%9A%84%E6%94%AF%E4%BB%98%E6%B5%81%E7%A8%8B"><span class="toc-number">2.16.</span> <span class="toc-text">说说你的支付流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%B4%E8%AF%B4%E4%BD%A0%E6%98%AF%E7%94%A8RabbitMQ%E9%83%BD%E5%B9%B2%E4%BA%86%E4%BB%80%E4%B9%88"><span class="toc-number">2.17.</span> <span class="toc-text">说说你是用RabbitMQ都干了什么</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%9A%84%E9%9B%86%E5%90%88"><span class="toc-number">3.</span> <span class="toc-text">Java中常见的集合</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AF%B4%E4%B8%80%E4%B8%8BHashMap%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-number">4.</span> <span class="toc-text">说一下HashMap的实现</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E6%9C%89%E5%93%AA%E4%BA%9B%E5%BC%95%E6%93%8E"><span class="toc-number">5.</span> <span class="toc-text">MySQL有哪些引擎</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AF%B4%E8%AF%B4%E4%BD%A0%E5%AF%B9innoDB%E7%9A%84%E7%90%86%E8%A7%A3"><span class="toc-number">6.</span> <span class="toc-text">说说你对innoDB的理解</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spring%E4%B8%AD%E7%9A%84IOC%E5%92%8CAOP"><span class="toc-number">7.</span> <span class="toc-text">Spring中的IOC和AOP</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%AF%B9-MySQL-%E8%BF%9B%E8%A1%8C%E7%9A%84%E8%B0%83%E4%BC%98"><span class="toc-number">8.</span> <span class="toc-text">如何对 MySQL 进行的调优</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91%E5%90%97"><span class="toc-number">9.</span> <span class="toc-text">了解红黑树吗</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AF%B4%E4%B8%80%E4%B8%8B%E8%87%AA%E5%AE%9A%E4%B9%89-SpringBoot-starters-%E7%9A%84%E6%B5%81%E7%A8%8B"><span class="toc-number">10.</span> <span class="toc-text">说一下自定义 SpringBoot starters 的流程</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9C%A8%E9%A1%B9%E7%9B%AE%E4%B8%AD%E4%BD%BF%E7%94%A8%E9%82%A3%E4%BA%9B%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%8C%E5%85%B7%E4%BD%93%E4%BB%8B%E7%BB%8D%E4%B8%80%E4%B8%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F"><span class="toc-number">11.</span> <span class="toc-text">在项目中使用那些设计模式，具体介绍一下单例模式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B9%90%E8%A7%82%E9%94%81%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%9A%84"><span class="toc-number">12.</span> <span class="toc-text">乐观锁如何实现的</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B4%A2%E5%BC%95%EF%BC%9F%E4%BD%9C%E7%94%A8%EF%BC%9F"><span class="toc-number">13.</span> <span class="toc-text">什么是数据库索引？作用？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A7%A3%E9%87%8A%E4%B8%80%E4%B8%8B%E8%81%9A%E9%9B%86%E7%B4%A2%E5%BC%95%E5%92%8C%E9%9D%9E%E8%81%9A%E9%9B%86%E7%B4%A2%E5%BC%95%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">14.</span> <span class="toc-text">解释一下聚集索引和非聚集索引的区别</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%94%AF%E4%B8%80%E7%B4%A2%E5%BC%95%EF%BC%9F%E4%BD%9C%E7%94%A8%EF%BC%9F"><span class="toc-number">15.</span> <span class="toc-text">什么是唯一索引？作用？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A7%A3%E9%87%8A%E4%B8%80%E4%B8%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B4%A2%E5%BC%95%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84B%E6%A0%91%E5%92%8CB-%E6%A0%91"><span class="toc-number">16.</span> <span class="toc-text">解释一下数据库索引的数据结构中常用的B树和B+树</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%83%85%E5%86%B5%E4%B8%8B%E5%BA%94%E8%AF%A5%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95%EF%BC%9F%E4%BB%80%E4%B9%88%E6%83%85%E5%86%B5%E4%B8%8B%E4%B8%8D%E5%BA%94%E8%AF%A5"><span class="toc-number">17.</span> <span class="toc-text">什么情况下应该创建索引？什么情况下不应该</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E4%BC%98%E5%8C%96%E7%B4%A2%E5%BC%95%E6%80%A7%E8%83%BD%EF%BC%9F%E5%88%97%E4%B8%BE%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81%E7%9A%84%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7"><span class="toc-number">18.</span> <span class="toc-text">如何优化索引性能？列举一些常见的索引优化技巧</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86%E9%95%BF%E6%97%B6%E9%97%B4%E8%BF%90%E8%A1%8C%E7%9A%84%E6%9F%A5%E8%AF%A2%E5%AF%BC%E8%87%B4%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%9F"><span class="toc-number">19.</span> <span class="toc-text">如何处理长时间运行的查询导致索引失效的问题？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AF%B4%E8%AF%B4TCP%E4%B8%8EUDP%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%8C%E4%BB%A5%E5%8F%8A%E5%90%84%E8%87%AA%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">20.</span> <span class="toc-text">说说TCP与UDP的区别，以及各自的优缺点</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#TCP%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E5%8F%AF%E9%9D%A0%E6%80%A7"><span class="toc-number">21.</span> <span class="toc-text">TCP如何保证可靠性</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E4%B8%8E%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B"><span class="toc-number">22.</span> <span class="toc-text">说说TCP的三次握手与四次挥手</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background: linear-gradient(135deg,#ace0f9,#a1c4fd)"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2023  <i id="heartbeat" class="fa fas fa-heartbeat"></i> duanthirty Violet</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">The worst way to miss someone is to be sitting right beside her <br> knowing you can't have her.</div></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><!--button#darkmode(type="button" title=_p('rightside.night_mode_title'))i.fas.fa-adjust--><a class="icon-V hidden" onclick="switchNightMode()" title="浅色和深色模式转换"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"><span id="percent">0<span>%</span></span></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadGiscus () {
  let nowTheme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'light'

  const config = Object.assign({
    src: 'https://giscus.app/client.js',
    'data-repo': 'duanthirty/duanthirty.github.io',
    'data-repo-id': 'R_kgDOGflxEw',
    'data-category-id': 'DIC_kwDOGflxE84CRxKp',
    'data-mapping': 'pathname',
    'data-theme': nowTheme,
    'data-reactions-enabled': '1',
    crossorigin: 'anonymous',
    async: true
  },null)

  let ele = document.createElement('script')
  for (let key in config) {
    ele.setAttribute(key, config[key])
  }
  document.getElementById('giscus-wrap').insertAdjacentElement('afterbegin',ele)
}

function changeGiscusTheme () {
  const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'light'

  function sendMessage(message) {
    const iframe = document.querySelector('iframe.giscus-frame');
    if (!iframe) return;
    iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
  }

  sendMessage({
    setConfig: {
      theme: theme
    }
  });
}

if ('Giscus' === 'Giscus' || !true) {
  if (true) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
  else loadGiscus()
} else {
  function loadOtherComment () {
    loadGiscus()
  }
}</script></div><div class="aplayer no-destroy" data-id="6831019121" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><script async src="/js/diytitle.js"></script><script src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer data-pjax src="/js/readPercent.js"></script><script>var meting_api='https://api.injahow.cn/meting/?server=netease&type=playlist&id=8495736674'</script><script src="/js/sun_moon.js" async></script><script src="/js/chocolate.js" async></script><script src="/js/universe.js" async></script><canvas id="universe"></canvas><script id="canvas_nest" defer="defer" color="255,192,203" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法制,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="false" async="async"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["link[rel=\"canonical\"]","meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show","#web_bg",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'G-RQZSMGWCQS', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
    function butterfly_categories_card_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<style>li.categoryBar-list-item{width:32.3%;}.categoryBar-list{max-height: 190px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 160px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"><li class="categoryBar-list-item" style="background:url(http://p0.itc.cn/images03/20200525/332e1ea10c634cbfaf0dfc5b69d00a3c.jpeg);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/力扣/&quot;);" href="javascript:void(0);">力扣</a><span class="categoryBar-list-count">13</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(http://p8.itc.cn/images03/20200525/377f4f7044fe49b0bb932f43ef4f4891.jpeg);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/实用教程/&quot;);" href="javascript:void(0);">实用教程</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(http://p8.itc.cn/images03/20200525/0ed549edde2c4d5eaecc2824e753ca74.jpeg);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/踩坑日记/&quot;);" href="javascript:void(0);">踩坑日记</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(http://p6.itc.cn/images03/20200525/8dedcdf6ace44a50a1deb6a9743821fe.jpeg);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/刷题日志/&quot;);" href="javascript:void(0);">刷题日志</a><span class="categoryBar-list-count">14</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(http://p9.itc.cn/images03/20200525/07539bdba160465d80d23b3f16db8620.jpeg);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/学习笔记/&quot;);" href="javascript:void(0);">学习笔记</a><span class="categoryBar-list-count">66</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(http://p8.itc.cn/images03/20200525/5f6cecf10ea04dec9a5d42bf9c4c3739.jpeg);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/实战项目/&quot;);" href="javascript:void(0);">实战项目</a><span class="categoryBar-list-count">3</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(http://p0.itc.cn/images03/20200525/332e1ea10c634cbfaf0dfc5b69d00a3c.jpeg);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/面试题/&quot;);" href="javascript:void(0);">面试题</a><span class="categoryBar-list-count">9</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(http://p8.itc.cn/images03/20200525/377f4f7044fe49b0bb932f43ef4f4891.jpeg);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/蓝桥杯/&quot;);" href="javascript:void(0);">蓝桥杯</a><span class="categoryBar-list-count">8</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(http://p8.itc.cn/images03/20200525/0ed549edde2c4d5eaecc2824e753ca74.jpeg);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/学习笔记/实战项目/&quot;);" href="javascript:void(0);">实战项目</a><span class="categoryBar-list-count">7</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(http://p6.itc.cn/images03/20200525/8dedcdf6ace44a50a1deb6a9743821fe.jpeg);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/杂谈/&quot;);" href="javascript:void(0);">杂谈</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr"></span></li></ul></div></div>';
      console.log('已挂载butterfly_categories_card')
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      }
    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    butterfly_categories_card_injector_config()
    }
  </script><script data-pjax>
  function butterfly_clock_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-clock/clock/images/weather/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_injector_config();
  }
  </script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script data-pjax src="https://cdn.jsdelivr.net/npm/hexo-butterfly-clock/lib/clock.min.js"></script><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><div id="ghbdages" style="overflow:hidden;max-height:90px;height:auto;text-align:center;margin-top:10px"><div class="swiper-wrapper"><div class="swiper-slide"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" title="博客框架为Hexo_v5.4.0"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" title="主题版本Butterfly_v4.1.0"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="本站项目由Github托管"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a></div><div class="swiper-slide"><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></div></div></div><style>a.github-badge:hover:before {display:none}</style>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/js/runtime.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-footer-beautify/lib/swiperbdage_init.min.js"></script><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2022/11/05/NewFeaturesOfJava8/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fi0.hdslb.com%2Fbfs%2Farticle%2F7195c774995376cbaf3c2868706521746c0e9142.png&amp;refer=http%3A%2F%2Fi0.hdslb.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1645330580&amp;t=7ef089d6818c156c451e5072f53f3597" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-11-05</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2022/11/05/NewFeaturesOfJava8/&quot;);" href="javascript:void(0);" alt="">Java 8新特性</a><div class="blog-slider__text">Java8新特性，之前只是草草看了一下，后来发现stream流操作挺好用的，来补一下票</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2022/11/05/NewFeaturesOfJava8/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2022/12/22/MeassageQueue/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic2.zhimg.com/v2-d0a0172a71b6bc4ff18cd1f11bfa6b3b_r.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-12-22</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2022/12/22/MeassageQueue/&quot;);" href="javascript:void(0);" alt="">MeassageQueue</a><div class="blog-slider__text">消息队列相关学习记录</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2022/12/22/MeassageQueue/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2022/12/21/Docker/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://img2.baidu.com/it/u=595920241,2439700946&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG?w=1422&amp;h=800" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-12-21</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2022/12/21/Docker/&quot;);" href="javascript:void(0);" alt="">Docker</a><div class="blog-slider__text">Docker实用篇学习笔记</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2022/12/21/Docker/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2022/12/24/ElasticSearch/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fpic3.zhimg.com%2Fv2-dbe4189cad999946abdcd174fba140ea_r.jpg&amp;refer=http%3A%2F%2Fpic3.zhimg.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1651217592&amp;t=44946406f8e7b9ed15f483e0495b33c9" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-12-24</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2022/12/24/ElasticSearch/&quot;);" href="javascript:void(0);" alt="">ElasticSearch</a><div class="blog-slider__text">分布式搜索引擎</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2022/12/24/ElasticSearch/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2022/11/08/SpringCloud/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://img2.baidu.com/it/u=595920241,2439700946&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG?w=1422&amp;h=800" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-11-08</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2022/11/08/SpringCloud/&quot;);" href="javascript:void(0);" alt="">SpringCloud</a><div class="blog-slider__text">SpringCloud学习笔记</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2022/11/08/SpringCloud/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2022/09/29/ReggieTakeOut/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://img0.baidu.com/it/u=1144121390,2782791282&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=889&amp;h=500" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-09-29</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2022/09/29/ReggieTakeOut/&quot;);" href="javascript:void(0);" alt="">瑞吉外卖</a><div class="blog-slider__text">瑞吉外卖实战项目</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2022/09/29/ReggieTakeOut/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2022/10/22/RedisPractice/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://img2.baidu.com/it/u=945409242,1491286515&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=PNG?w=889&amp;h=500" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-10-22</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2022/10/22/RedisPractice/&quot;);" href="javascript:void(0);" alt="">Redis实战篇</a><div class="blog-slider__text">Redis实战篇，包含优惠券秒杀，分布式锁，消息队列用户签到等功能</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2022/10/22/RedisPractice/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/issues.js"></script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"log":false});</script></body></html>